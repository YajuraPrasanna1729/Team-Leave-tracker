function parseDateFlexible(str) {
  if (!str) return null;
  str = str.trim().replace(/\r|\n/g, "");
  
  // Try multiple known date formats
  const formats = [
    /^(\d{1,2})[\/\-\.](\d{1,2})[\/\-\.](\d{2,4})$/,  // 21/10/2025 or 21-10-25
    /^(\d{4})[\/\-\.](\d{1,2})[\/\-\.](\d{1,2})$/,    // 2025-10-21
  ];

  for (const f of formats) {
    const m = str.match(f);
    if (m) {
      let [_, a, b, c] = m.map(x => x.trim());
      let day, month, year;

      if (f === formats[1]) {
        year = +a; month = +b; day = +c;
      } else {
        // If year looks like '25' assume 2025
        if (c.length === 2) c = "20" + c;
        day = +a; month = +b; year = +c;
      }

      const date = new Date(year, month - 1, day);
      if (!isNaN(date)) return date;
    }
  }
  return null;
}
